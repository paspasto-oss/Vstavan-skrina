function generateCutList() {
    const W = getVal("W"), H = getVal("H"), D = getVal("D"), t = getVal("t"), setback = getVal("setback");
    const dCount = getVal("doors"), overlap = getVal("overlap"), hW = getVal("handleW");
    const parts = [];

    // 1. DORAZOVÝ RÁM A KONŠTRUKCIA (BEZ DNA)
    addPart(parts, "Dorazová lišta zvislá", "DTD", H, 100, 2, "Montáž na stenu");
    addPart(parts, "Dorazová lišta vodorovná", "DTD", W - 200, 100, 1, "Len na STROP");
    
    // Vonkajšie boky stoja na podlahe
    addPart(parts, "Bok skrine vonkajší", "DTD", H, D, 2, "Stojí priamo na podlahe");
    
    // Pôda (vrchný diel)
    addPart(parts, "Pôda (strop skrine)", "DTD", W - (2*t), D, 1);
    
    // Chrbát (odpočítame len 5mm od stropu po zem)
    addPart(parts, "Chrbát (Sololit)", "HDF", H - 5, W - 5, 1);

    // 2. VNÚTORNÉ DELENIE (Stojky idú od zeme až po pôdu)
    state.sections.forEach((sec, sIdx) => {
      // Vnútorné stojky sú teraz vyššie (H - hrúbka pôdy)
      if (sIdx < state.sections.length - 1) {
        addPart(parts, "Stojka vnútorná", "DTD", H - t, D - setback, 1, `Od podlahy po pôdu`);
      }
      
      sec.modules.forEach(m => {
        if (m.type === "shelf") addPart(parts, "Polica pevná", "DTD", sec.width, D - setback, 1, `Sekcia ${sIdx+1}`);
        if (m.type === "drawers") {
            const drawerDepth = getVal("drawerDepth");
            const sideGap = 13; 
            const innerW = sec.width - (2 * sideGap);
            
            // Modern Box 3D - dno a chrbát 18mm
            addPart(parts, "Zásuvka dno (18mm)", "DTD", innerW - 75, drawerDepth - 10, m.count, "Modern Box 3D");
            addPart(parts, "Zásuvka chrbát (18mm)", "DTD", innerW - 87, 135, m.count, "Pre Modern Box H140");
            addPart(parts, "Zásuvka čelo viditeľné", "DTD", sec.width - 4, (m.height/m.count) - 4, m.count);
        }
        if (m.type === "rod") addPart(parts, "Šatníková tyč", "Kov", sec.width - 4, 0, 1);
      });
    });

    // 3. POSUVNÉ DVERE (Koľajnica priamo na podlahe)
    const wingW = (W - (2 * t) + (dCount - 1) * overlap) / dCount;
    // Výška krídla: Svetlosť H - stropná doska (t) - vôľa na koľajnice (40mm)
    const wingH = H - t - 40; 
    
    const fillW = wingW - (hW * 2) + 14; 
    const fillH = wingH - 38; 
    
    addPart(parts, "Výplň dverí (DTD 10mm)", "DTD", fillH, fillW, dCount, "Hliníkový rám");
    addPart(parts, "Madlo zvislé", "Profil AL", wingH, 0, dCount * 2);
    addPart(parts, "Profil vodorovný", "Profil AL", wingW - (hW * 2), 0, dCount * 2);
    
    // Koľajnice
    addPart(parts, "Koľajnica horná", "AL", W - (2*t), 0, 1);
    addPart(parts, "Koľajnica dolná", "AL", W - (2*t), 0, 1, "Nalepiť priamo na podlahu");

    renderTable(parts);
  }
